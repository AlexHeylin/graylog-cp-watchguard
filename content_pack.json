{
	"name": "Watchguard Content Pack",
	"description": "Watchguard logs parsed by Graylog",
	"category": "Firewalls",
	"inputs": [{
			"id": "5a6ee6fc954f3f085a89776f",
			"title": "watchguard-syslog-udp",
			"configuration": {
				"expand_structured_data": false,
				"recv_buffer_size": 262144,
				"port": 55514,
				"override_source": null,
				"force_rdns": false,
				"allow_override_date": true,
				"bind_address": "0.0.0.0",
				"store_full_message": false
			},
			"static_fields": {
				"from_syslog": "true"
			},
			"type": "org.graylog2.inputs.syslog.udp.SyslogUDPInput",
			"global": false,
			"extractors": [{
					"title": "Fireware msg Name",
					"type": "LOOKUP_TABLE",
					"cursor_strategy": "COPY",
					"target_field": "msg_name",
					"source_field": "msg_id",
					"configuration": {
						"lookup_table_name": "lookup-table-fireware-msg-id-to-name"
					},
					"converters": [],
					"condition_type": "NONE",
					"condition_value": "",
					"order": 3
				}, {
					"title": "Fireware msg Area",
					"type": "LOOKUP_TABLE",
					"cursor_strategy": "COPY",
					"target_field": "msg_area",
					"source_field": "msg_id",
					"configuration": {
						"lookup_table_name": "lookup-table-fireware-msg-id-to-area"
					},
					"converters": [],
					"condition_type": "NONE",
					"condition_value": "",
					"order": 2
				}, {
					"title": "Fireware msg Level",
					"type": "LOOKUP_TABLE",
					"cursor_strategy": "COPY",
					"target_field": "msg_level",
					"source_field": "msg_id",
					"configuration": {
						"lookup_table_name": "lookup-table-fireware-msg-id-to-level"
					},
					"converters": [],
					"condition_type": "NONE",
					"condition_value": "",
					"order": 4
				}, {
					"title": "Name of firewall policy",
					"type": "REGEX",
					"cursor_strategy": "COPY",
					"target_field": "policy_name",
					"source_field": "message",
					"configuration": {
						"regex_value": "^.*\\((.*)-\\d\\d\\)"
					},
					"converters": [],
					"condition_type": "REGEX",
					"condition_value": "^.*\\((.*)-\\d\\d\\)",
					"order": 0
				}, {
					"title": "Fireware msg Description",
					"type": "LOOKUP_TABLE",
					"cursor_strategy": "COPY",
					"target_field": "msg_desc",
					"source_field": "msg_id",
					"configuration": {
						"lookup_table_name": "lookup-table-fireware-msg-id-to-description"
					},
					"converters": [],
					"condition_type": "NONE",
					"condition_value": "",
					"order": 5
				}, {
					"title": "Message ID",
					"type": "REGEX",
					"cursor_strategy": "COPY",
					"target_field": "msg_id",
					"source_field": "message",
					"configuration": {
						"regex_value": "^.*msg_id=\\\"(\\S\\S\\S\\S-\\S\\S\\S\\S)\\\""
					},
					"converters": [],
					"condition_type": "REGEX",
					"condition_value": "^.*: msg_id.*",
					"order": 1
				}, {
					"title": "Firewall PacketFilter INFO 3000-0148",
					"type": "GROK",
					"cursor_strategy": "COPY",
					"target_field": "",
					"source_field": "message",
					"configuration": {
						"grok_pattern": "^.* %{NOTSPACE:action} %{NOTSPACE:srcif} %{NOTSPACE:dstif} %{BASE10NUM:ip_pkt_len} %{NOTSPACE:protocol} %{BASE10NUM:iph_len} %{BASE10NUM:TTL} (%{IPV4:srcip}|%{DATA:srcuser}) (%{IPV4:dstip}|%{DATA:dstuser}) %{BASE10NUM:srcport} %{BASE10NUM:dstport} %{DATA:ip_pkt_info} ((?:\\s+(geo_src=\"%{DATA:geo_src}\"|geo_dst=\"%{DATA:geo_dst}\")?)|\\()"
					},
					"converters": [],
					"condition_type": "REGEX",
					"condition_value": "^.*msg_id=\"3000-0148\".*",
					"order": 8
				}, {
					"title": "Proxy HTTP INFO 1AFF-0024",
					"type": "GROK",
					"cursor_strategy": "COPY",
					"target_field": "",
					"source_field": "message",
					"configuration": {
						"grok_pattern": "^.* %{NOTSPACE:action} %{NOTSPACE:srcif} %{NOTSPACE:dstif} %{NOTSPACE:protocol} %{IPV4:srcip} %{IPV4:dstip} %{BASE10NUM:srcport} %{BASE10NUM:dstport} msg=\"%{DATA:proxy_msg}\" proxy_act=\"%{DATA:proxy_action}\" op=\"%{NOTSPACE:proxy_op}\" dstname=\"%{DATA:proxy_dstname}\" arg=\"%{DATA:proxy_arg}\" sent_bytes=\"%{BASE10NUM:sent_bytes}\" rcvd_bytes=\"%{BASE10NUM:rcvd_bytes}\" elapsed_time=\"%{SECOND:elapsed_time} sec\\(s\\)\" (?:\\s+(geo_dst=\"%{DATA:geo_dst}\")?)",
						"named_captures_only": false
					},
					"converters": [],
					"condition_type": "REGEX",
					"condition_value": "^.*msg_id=\"1AFF-0024\".*",
					"order": 6
				}, {
					"title": "Proxy HTTPS INFO 2CFF-0000",
					"type": "GROK",
					"cursor_strategy": "COPY",
					"target_field": "",
					"source_field": "message",
					"configuration": {
						"grok_pattern": "^.* %{NOTSPACE:action} %{NOTSPACE:srcif} %{NOTSPACE:dstif} %{NOTSPACE:protocol} %{IPV4:srcip} %{IPV4:dstip} %{BASE10NUM:srcport} %{BASE10NUM:dstport} msg=\"%{DATA:proxy_msg}\" proxy_act=\"%{DATA:proxy_action}\" sni=\"%{DATA:sni}\" cn=\"%{DATA:cn}\" cert_issuer=\"%{DATA:cert_issuer}\" cert_subject=\"%{DATA:cert_subject}\" action=\"%{DATA:cert_action}\" app_id=\"%{DATA:app_id}\" app_cat_id=\"%{DATA:app_cat_id}\" sent_bytes=\"%{BASE10NUM:sent_bytes}\" rcvd_bytes=\"%{BASE10NUM:rcvd_bytes}\" (?:\\s+(geo_dst=\"%{DATA:geo_dst}\")?)"
					},
					"converters": [],
					"condition_type": "REGEX",
					"condition_value": "^.*msg_id=\"2CFF-0000\".*",
					"order": 7
				}, {
					"title": "geo_dst to coordinates",
					"type": "LOOKUP_TABLE",
					"cursor_strategy": "COPY",
					"target_field": "geo_coords",
					"source_field": "geo_dst",
					"configuration": {
						"lookup_table_name": "Countrycode3_to_latlong"
					},
					"converters": [],
					"condition_type": "NONE",
					"condition_value": "",
					"order": 11
				}, {
					"title": "Proxy SMTP INFO 1BFF-0001",
					"type": "GROK",
					"cursor_strategy": "COPY",
					"target_field": "",
					"source_field": "message",
					"configuration": {
						"grok_pattern": "^.* %{NOTSPACE:action} %{NOTSPACE:srcif} %{NOTSPACE:dstif} %{NOTSPACE:protocol} %{IPV4:srcip} %{IPV4:dstip} %{BASE10NUM:srcport} %{BASE10NUM:dstport} msg=\"%{DATA:proxy_msg}\" proxy_act=\"%{DATA:proxy_action}\" keyword=\"%{NOTSPACE:keyword} ((?:\\s+(geo_src=\"%{DATA:geo_src}\"|geo_dst=\"%{DATA:geo_dst}\")?)|\\()"
					},
					"converters": [],
					"condition_type": "REGEX",
					"condition_value": "^.*msg_id=\"1BFF-0001\".*",
					"order": 9
				}, {
					"title": "Proxy SMTP INFO 1BFF-000F",
					"extractor_type": "grok",
					"converters": [],
					"order": 10,
					"cursor_strategy": "copy",
					"source_field": "message",
					"target_field": "",
					"extractor_config": {
						"grok_pattern": "^.* %{NOTSPACE:action} %{NOTSPACE:srcif} %{NOTSPACE:dstif} %{NOTSPACE:protocol} %{IPV4:srcip} %{IPV4:dstip} %{BASE10NUM:srcport} %{BASE10NUM:dstport} msg=\"%{DATA:proxy_msg}\" proxy_act=\"%{DATA:proxy_action}\" rcvd_bytes=\"%{BASE10NUM:rcvd_bytes}\" sent_bytes=\"%{BASE10NUM:sent_bytes}\" sender=\"%{EMAILADDRESS:sender}\" recipients=\"%{EMAILADDRESS:recipients}\" server_ssl=\"%{DATA:server_ssl}\" client_ssl=\"%{DATA:client_ssl}\" ((?:\\s+(geo_src=\"%{DATA:geo_src}\"|geo_dst=\"%{DATA:geo_dst}\")?)|\\()"
					},
					"condition_type": "regex",
					"condition_value": "^.*msg_id=\"1BFF-000F\".*"
				}
			]
		}
	],
	"streams": [],
	"outputs": [],
	"dashboards": [],
	"grok_patterns": [],
	"lookup_tables": [{
			"title": "Lookup Table Fireware msg ID to Name",
			"description": "Lookup Table for Watchguard msg ID's - http://www.watchguard.com/help/docs/fireware/11/en-US/log_catalog/index.html",
			"name": "lookup-table-fireware-msg-id-to-name",
			"cache_name": "fireware-msg_id-cache",
			"data_adapter_name": "fireware-msg-id-to-name-lookup",
			"default_single_value": "",
			"default_single_value_type": "NULL",
			"default_multi_value": "",
			"default_multi_value_type": "NULL"
		}, {
			"title": "Lookup Table Fireware msg ID to Area",
			"description": "Lookup Table for Watchguard msg ID's - http://www.watchguard.com/help/docs/fireware/11/en-US/log_catalog/index.html",
			"name": "lookup-table-fireware-msg-id-to-area",
			"cache_name": "fireware-msg_id-cache",
			"data_adapter_name": "fireware-msg-id-to-area-lookup",
			"default_single_value": "",
			"default_single_value_type": "NULL",
			"default_multi_value": "",
			"default_multi_value_type": "NULL"
		}, {
			"title": "Countrycode3_to_latlong",
			"description": "Use Lookuptable to convert the UN Code to latitude and longitude",
			"name": "Countrycode3_to_latlong",
			"cache_name": "country-code-table",
			"data_adapter_name": "countrycode-3dig-to-2dig",
			"default_single_value": "",
			"default_single_value_type": "NULL",
			"default_multi_value": "",
			"default_multi_value_type": "NULL"
		}, {
			"title": "Lookup Table Fireware msg ID to Level",
			"description": "Lookup Table for Watchguard msg ID's - http://www.watchguard.com/help/docs/fireware/11/en-US/log_catalog/index.html",
			"name": "lookup-table-fireware-msg-id-to-level",
			"cache_name": "fireware-msg_id-cache",
			"data_adapter_name": "fireware-msg-id-to-level-lookup",
			"default_single_value": "",
			"default_single_value_type": "NULL",
			"default_multi_value": "",
			"default_multi_value_type": "NULL"
		}, {
			"title": "Lookup Table Fireware msg ID to Description",
			"description": "Lookup Table for Watchguard msg ID's - http://www.watchguard.com/help/docs/fireware/11/en-US/log_catalog/index.html",
			"name": "lookup-table-fireware-msg-id-to-description",
			"cache_name": "fireware-msg_id-cache",
			"data_adapter_name": "fireware-msg-id-to-description-lookup",
			"default_single_value": "",
			"default_single_value_type": "NULL",
			"default_multi_value": "",
			"default_multi_value_type": "NULL"
		}
	],
	"lookup_caches": [{
			"title": "Country Code Table",
			"description": "Table of country codes",
			"name": "country-code-table",
			"config": {
				"type": "guava_cache",
				"max_size": 1000,
				"expire_after_access": 600,
				"expire_after_access_unit": "SECONDS",
				"expire_after_write": 0,
				"expire_after_write_unit": null
			}
		}, {
			"title": "Fireware msg_ID Cache",
			"description": "Cache for csv Lookup of Fireware msg_id's",
			"name": "fireware-msg_id-cache",
			"config": {
				"type": "guava_cache",
				"max_size": 50,
				"expire_after_access": 30,
				"expire_after_access_unit": "SECONDS",
				"expire_after_write": 0,
				"expire_after_write_unit": null
			}
		}
	],
	"lookup_data_adapters": [{
			"title": "Fireware msg ID to Description Lookup",
			"description": "Lookup Table for Watchguard msg ID's - http://www.watchguard.com/help/docs/fireware/11/en-US/log_catalog/index.html",
			"name": "fireware-msg-id-to-description-lookup",
			"config": {
				"type": "csvfile",
				"path": "/etc/graylog/fireware_msg_id_lookup_table.csv",
				"separator": ",",
				"quotechar": "\"",
				"key_column": "msg_id",
				"value_column": "msg_desc",
				"check_interval": 180,
				"case_insensitive_lookup": false
			}
		}, {
			"title": "Fireware msg ID to Level Lookup",
			"description": "Lookup Table for Watchguard msg ID's - http://www.watchguard.com/help/docs/fireware/11/en-US/log_catalog/index.html",
			"name": "fireware-msg-id-to-level-lookup",
			"config": {
				"type": "csvfile",
				"path": "/etc/graylog/fireware_msg_id_lookup_table.csv",
				"separator": ",",
				"quotechar": "\"",
				"key_column": "msg_id",
				"value_column": "msg_level",
				"check_interval": 180,
				"case_insensitive_lookup": false
			}
		}, {
			"title": "Fireware msg ID to Area Lookup",
			"description": "Lookup Table for Watchguard msg ID's - http://www.watchguard.com/help/docs/fireware/11/en-US/log_catalog/index.html",
			"name": "fireware-msg-id-to-area-lookup",
			"config": {
				"type": "csvfile",
				"path": "/etc/graylog/fireware_msg_id_lookup_table.csv",
				"separator": ",",
				"quotechar": "\"",
				"key_column": "msg_id",
				"value_column": "msg_area",
				"check_interval": 180,
				"case_insensitive_lookup": false
			}
		}, {
			"title": "countrycode 3dig to latlong",
			"description": "Lookup the countrycode table to convert 3 digit country code(UN) to 2digit country code(ISO)",
			"name": "countrycode-3dig-to-2dig",
			"config": {
				"type": "csvfile",
				"path": "/etc/graylog/countrycode_lookup_table.csv",
				"separator": ";",
				"quotechar": "'",
				"key_column": "ccode_un_a3",
				"value_column": "ccode_latlong",
				"check_interval": 600,
				"case_insensitive_lookup": false
			}
		}, {
			"title": "Fireware msg ID to Name Lookup",
			"description": "Lookup Table for Watchguard msg ID's - http://www.watchguard.com/help/docs/fireware/11/en-US/log_catalog/index.html",
			"name": "fireware-msg-id-to-name-lookup",
			"config": {
				"type": "csvfile",
				"path": "/etc/graylog/fireware_msg_id_lookup_table.csv",
				"separator": ",",
				"quotechar": "\"",
				"key_column": "msg_id",
				"value_column": "msg_name",
				"check_interval": 180,
				"case_insensitive_lookup": false
			}
		}
	]
}
